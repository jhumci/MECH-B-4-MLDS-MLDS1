<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.37">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>8&nbsp; Erweiterungen der Linearen Regression â€“ Machine Learning and Data Science 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../regression/predictions_linear_regression.html" rel="next">
<link href="../regression/basic_linear_regression.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-29e2c20b02301cfff04dc8050bf30c7e.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-43df0d6f53b733b42d37fa7808e17715.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-35a0a6ff63dc489592d737420f28c51a.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-3553ea59eb901081601ef76abf8d5447.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../regression/index.html">Regressions-Analyse</a></li><li class="breadcrumb-item"><a href="../regression/advanced_linear_regression.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Erweiterungen der Linearen Regression</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Machine Learning and Data Science 1</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/jhumci/MECH-B-4-MLDS-MLDS1" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Einleitung</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../dataexploratory/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Umgang mit Daten und Explorative Analyse</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../dataexploratory/data_science.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Data Science, Statisik, und Machine Learning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../dataexploratory/data_sets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Sets</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../dataexploratory/tutorial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorial: Getting Data Tidy and finding Correlation</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../statistics/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistik</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistics/sampling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Stichproben und Zufallsvariablen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistics/distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Verteilungen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistics/tutorial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorial: Monte Carlo Simulation of Vehicle Component Failure</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistics/interference_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Interferenz</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistics/interference_advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Tests</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistics/tutorial_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorial 2: Muster in Netzlasten verstehen</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statistics/tasks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ãœbungsaufgaben: Wahrscheinlichkeitsrechnung</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regressions-Analyse</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regression/basic_linear_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regression/advanced_linear_regression.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Erweiterungen der Linearen Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regression/predictions_linear_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Vorhersagen mittels Linearen Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regression/tutorial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorial 1: Vorhersage von Netzlasten</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regression/logistic_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Klassifikation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../aufgaben/uebungsaufgaben.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ãœbungsaufgaben Klausurvorbereitung</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#abbildung-nicht-linearer-zusammenhÃ¤nge-mit-linearen-modellen" id="toc-abbildung-nicht-linearer-zusammenhÃ¤nge-mit-linearen-modellen" class="nav-link active" data-scroll-target="#abbildung-nicht-linearer-zusammenhÃ¤nge-mit-linearen-modellen"><span class="header-section-number">8.1</span> Abbildung nicht-linearer ZusammenhÃ¤nge mit Linearen Modellen</a></li>
  <li><a href="#umgang-mit-kategorischen-variablen" id="toc-umgang-mit-kategorischen-variablen" class="nav-link" data-scroll-target="#umgang-mit-kategorischen-variablen"><span class="header-section-number">8.2</span> Umgang mit Kategorischen Variablen</a>
  <ul class="collapse">
  <li><a href="#dummy-variablen" id="toc-dummy-variablen" class="nav-link" data-scroll-target="#dummy-variablen"><span class="header-section-number">8.2.1</span> Dummy-Variablen</a></li>
  <li><a href="#one-hot-encoding" id="toc-one-hot-encoding" class="nav-link" data-scroll-target="#one-hot-encoding"><span class="header-section-number">8.2.2</span> One-Hot-Encoding</a></li>
  <li><a href="#modell-nur-mit-kategorischen-variablen" id="toc-modell-nur-mit-kategorischen-variablen" class="nav-link" data-scroll-target="#modell-nur-mit-kategorischen-variablen"><span class="header-section-number">8.2.3</span> Modell nur mit Kategorischen Variablen</a></li>
  <li><a href="#modell-mit-allen-variablen" id="toc-modell-mit-allen-variablen" class="nav-link" data-scroll-target="#modell-mit-allen-variablen"><span class="header-section-number">8.2.4</span> Modell mit allen Variablen</a></li>
  </ul></li>
  <li><a href="#matrixschreibweise-der-linearen-regression" id="toc-matrixschreibweise-der-linearen-regression" class="nav-link" data-scroll-target="#matrixschreibweise-der-linearen-regression"><span class="header-section-number">8.3</span> Matrixschreibweise der linearen Regression</a>
  <ul class="collapse">
  <li><a href="#konkretes-beispiel" id="toc-konkretes-beispiel" class="nav-link" data-scroll-target="#konkretes-beispiel"><span class="header-section-number">8.3.1</span> Konkretes Beispiel</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/jhumci/MECH-B-4-MLDS-MLDS1/edit/main/regression/advanced_linear_regression.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/jhumci/MECH-B-4-MLDS-MLDS1/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../regression/index.html">Regressions-Analyse</a></li><li class="breadcrumb-item"><a href="../regression/advanced_linear_regression.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Erweiterungen der Linearen Regression</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-regression-linear-advanced" class="quarto-section-identifier"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Erweiterungen der Linearen Regression</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>ZusammenhÃ¤nge kÃ¶nnen auch zwischen mehr als zwei Variablen bestehen. In diesem Fall sprechen wir von einer multiplen linearen Regression. Das Modell kann dann wie folgt formuliert werden:</p>
<p><span class="math display">\[
Y = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \ldots + \beta_p X_p + \epsilon
\]</span></p>
<p>Als Beispiel kÃ¶nnten wir nicht nur die Absatzmenge eines Produkts in AbhÃ¤ngigkeit von der Werbeausgabe fÃ¼r TV-Spots, sondern auch von der Werbeausgabe fÃ¼r Radio-Spots modellieren. Wir simuliieren die Daten wieder mit Python, so dass wir die ZusammenhÃ¤nge kennen.</p>
<div id="c9edd512" class="cell styled-output" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate population data</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">0</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>X_1 <span class="op">=</span> <span class="dv">300</span> <span class="op">*</span> np.random.rand(<span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>X_2 <span class="op">=</span> <span class="dv">100</span> <span class="op">*</span> np.random.rand(<span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>X_3 <span class="op">=</span> <span class="dv">200</span> <span class="op">*</span> np.random.rand(<span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> <span class="dv">7</span> <span class="op">+</span> <span class="fl">0.05</span> <span class="op">*</span> X_1 <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> X_2 <span class="op">+</span> <span class="fl">0.2</span> <span class="op">*</span> X_3 <span class="op">+</span> <span class="dv">5</span> <span class="op">*</span> np.random.randn(<span class="dv">100</span>, <span class="dv">1</span>) <span class="op">+</span>  <span class="fl">0.1</span> <span class="op">*</span> X_1 <span class="op">*</span> X_2</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate sample data</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>sample_size <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>idx <span class="op">=</span> np.random.choice(<span class="dv">100</span>, sample_size, replace<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>X_sample <span class="op">=</span> [X_1[idx], X_2[idx], X_3[idx]]</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>Y_sample <span class="op">=</span> Y[idx]</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Store data in a tidy dataframe</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.DataFrame({<span class="st">"X_1 (TV advertising spending (â‚¬))"</span>: X_sample[<span class="dv">0</span>].flatten(), <span class="st">"X_2 (Radio advertising spending (â‚¬))"</span>: X_sample[<span class="dv">1</span>].flatten(), <span class="st">"X_3 (Newspaper advertising spending (â‚¬))"</span>: X_sample[<span class="dv">2</span>].flatten(), <span class="st">"Y (Sales)"</span>: Y_sample.flatten()})</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   X_1 (TV advertising spending (â‚¬))  X_2 (Radio advertising spending (â‚¬))  \
0                         261.003644                             69.253159   
1                         138.443809                             95.608363   
2                         156.554497                             66.017354   
3                         207.741636                             23.789282   
4                          79.616847                             61.396596   

   X_3 (Newspaper advertising spending (â‚¬))    Y (Sales)  
0                                166.209691  1859.370107  
1                                 54.708407  1353.996485  
2                                189.474118  1096.313335  
3                                  2.647372   513.700056  
4                                 29.628172   517.255193  </code></pre>
</div>
</div>
<p>Wir kÃ¶nnen nun drei unabhÃ¤ngige Modelle fitten und visualisieren.</p>
<div id="d87da02a" class="cell styled-output" data-fig-label="fig:regression-linear-advanced-linear-regression_three" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> [<span class="st">"TV advertising spending (â‚¬)"</span>, <span class="st">"Radio advertising spending (â‚¬)"</span>, <span class="st">"Newspaper advertising spending (â‚¬)"</span>]</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> predictor <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fit the model</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> LinearRegression()</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    model.fit(X_sample[predictor].reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), Y_sample)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Predict the values</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    Y_pred <span class="op">=</span> model.predict(X_sample[predictor].reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot the data</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    plt.scatter(X_sample[predictor], Y_sample, color<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    plt.plot(X_sample[predictor], Y_pred, color<span class="op">=</span><span class="st">'blue'</span>, linewidth<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(labels[predictor])</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">"Sales"</span>)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="ss">f"Linear Regression with </span><span class="sc">{</span>labels[predictor]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot R^2</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    plt.text(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="ss">f"$R^2$ = </span><span class="sc">{</span>model<span class="sc">.</span>score(X_sample[predictor].reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), Y_sample)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">Y = </span><span class="sc">{</span>model<span class="sc">.</span>intercept_[<span class="dv">0</span>]<span class="sc">:.2f}</span><span class="ss"> + </span><span class="sc">{</span>model<span class="sc">.</span>coef_[<span class="dv">0</span>][<span class="dv">0</span>]<span class="sc">:.2f}</span><span class="ss"> * X$"</span>, transform<span class="op">=</span>plt.gca().transAxes)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="advanced_linear_regression_files/figure-html/cell-3-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Lineare Regression fÃ¼r die drei unabhÃ¤ngigen Variablen"><img src="advanced_linear_regression_files/figure-html/cell-3-output-1.png" width="601" height="449" alt="Lineare Regression fÃ¼r die drei unabhÃ¤ngigen Variablen" class="figure-img"></a></p>
<figcaption>Lineare Regression fÃ¼r die drei unabhÃ¤ngigen Variablen</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="advanced_linear_regression_files/figure-html/cell-3-output-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="advanced_linear_regression_files/figure-html/cell-3-output-2.png" width="601" height="449" class="figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="advanced_linear_regression_files/figure-html/cell-3-output-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="advanced_linear_regression_files/figure-html/cell-3-output-3.png" width="601" height="449" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>Offensichtlich sind die Modelle von mittlerer QualitÃ¤t. Wir kÃ¶nnen die drei unabhÃ¤ngigen Variablen auch in einem Modell zusammenfassen.</p>
<div id="dac45dd9" class="cell styled-output" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit linear regression model</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>X_sm <span class="op">=</span> sm.add_constant(data[[<span class="st">"X_1 (TV advertising spending (â‚¬))"</span>, <span class="st">"X_2 (Radio advertising spending (â‚¬))"</span>, <span class="st">"X_3 (Newspaper advertising spending (â‚¬))"</span>]])</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>model_sm <span class="op">=</span> sm.OLS(data[<span class="st">"Y (Sales)"</span>], X_sm).fit()</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Get slope and intercept</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model_sm.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            OLS Regression Results                            
==============================================================================
Dep. Variable:              Y (Sales)   R-squared:                       0.853
Model:                            OLS   Adj. R-squared:                  0.848
Method:                 Least Squares   F-statistic:                     185.7
Date:                Tue, 03 Jun 2025   Prob (F-statistic):           7.83e-40
Time:                        09:47:27   Log-Likelihood:                -683.06
No. Observations:                 100   AIC:                             1374.
Df Residuals:                      96   BIC:                             1385.
Df Model:                           3                                         
Covariance Type:            nonrobust                                         
============================================================================================================
                                               coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------------------------------------
const                                     -689.7437     78.760     -8.757      0.000    -846.082    -533.406
X_1 (TV advertising spending (â‚¬))            4.8871      0.265     18.429      0.000       4.361       5.414
X_2 (Radio advertising spending (â‚¬))        13.3451      0.835     15.986      0.000      11.688      15.002
X_3 (Newspaper advertising spending (â‚¬))     0.6292      0.382      1.646      0.103      -0.130       1.388
==============================================================================
Omnibus:                        2.763   Durbin-Watson:                   1.906
Prob(Omnibus):                  0.251   Jarque-Bera (JB):                2.632
Skew:                          -0.394   Prob(JB):                        0.268
Kurtosis:                       2.891   Cond. No.                         679.
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</code></pre>
</div>
</div>
<p>Wir kÃ¶nnen das Modell visualisieren, indem wir dreidimensionale Daten plotten. Wir lassen <span class="math inline">\(x_3\)</span> weg, da es den geringsten Einfluss auf die abhÃ¤ngige Variable zu haben scheint.</p>
<div id="38613998" class="cell styled-output" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mpl_toolkits.mplot3d <span class="im">import</span> Axes3D</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure()</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">111</span>, projection<span class="op">=</span><span class="st">'3d'</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the data</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>ax.scatter(X_sample[<span class="dv">0</span>], X_sample[<span class="dv">1</span>], Y_sample, color<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the regression plane</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>x1 <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">300</span>, <span class="dv">100</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>x2 <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">100</span>, <span class="dv">100</span>)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>X1, X2 <span class="op">=</span> np.meshgrid(x1, x2)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>Y_pred <span class="op">=</span> model_sm.params[<span class="dv">0</span>] <span class="op">+</span> model_sm.params[<span class="dv">1</span>] <span class="op">*</span> X1 <span class="op">+</span> model_sm.params[<span class="dv">2</span>] <span class="op">*</span> X2 <span class="op">+</span> model_sm.params[<span class="dv">3</span>] <span class="op">*</span> <span class="dv">0</span>    </span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>ax.plot_surface(X1, X2, Y_pred, alpha<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'X_1 (TV advertising spending (â‚¬))'</span>)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'X_2 (Radio advertising spending (â‚¬))'</span>)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>ax.set_zlabel(<span class="st">'Y (Sales)'</span>)</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>ax.set_zlabel(<span class="st">'Y'</span>)</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_3603/1194729202.py:14: FutureWarning:

Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="advanced_linear_regression_files/figure-html/cell-5-output-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="advanced_linear_regression_files/figure-html/cell-5-output-2.png" width="413" height="396" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>Das Modell ist linear und jede der drei Variablen hat einen positiven Einfluss auf die abhÃ¤ngige Variable. Das Modell kann wie folgt geschrieben werden:</p>
<p><span class="math display">\[
Y =  -689.7 + 4.9 X_1 + 13.3 X_2 + 0.6 X_3,
\]</span></p>
<p>oder noch klarer:</p>
<p><span class="math display">\[
\text{sales} = 689.7 \text{units} + 4.9 \frac{\text{units}}{Euro} \times \text{TV advertising spending} + 13.3 \frac{\text{units}}{Euro} \times \text{Radio advertising spending} + 0.6 \frac{\text{units}}{Euro} \times \text{Newspaper advertising spending}.
\]</span></p>
<p>Dieses lineare Modell eigent sich ausgezeichnet fÃ¼r eine Interpretation des Daten.</p>
<ul>
<li>Gibt es einen Zusammenhang zwischen den Werbeausgaben und den VerkÃ¤ufen?
<ul>
<li><em>Aus den p-Werten Koeffizienten kÃ¶nnen wir ablesen, dass die Koeffizienten fÃ¼r TV- und Radio-Werbung signifikant sind, wÃ¤hrend der Koeffizient fÃ¼r Zeitungswerbung nicht signifikant ist.</em></li>
</ul></li>
<li>Wie stark ist der Zusammenhang?
<ul>
<li><em>Der Wer des Koeffizienten ergibt z.B. ca. 4.9 abgesetzte Einheiten pro â‚¬ TV-Budget</em></li>
</ul></li>
<li>Welche Ausgaben haben den grÃ¶ÃŸten Einfluss auf die VerkÃ¤ufe?
<ul>
<li><em>Radio-Werbung hat den grÃ¶ÃŸten Einfluss auf die VerkÃ¤ufe.</em></li>
</ul></li>
<li>Ist die Beziehung linear oder nicht-linear?
<ul>
<li><em>Das Lineare Modell ist eine gute NÃ¤herung fÃ¼r die Daten, da <span class="math inline">\(R^2=0.85\)</span></em></li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Korrelation und KausalitÃ¤t
</div>
</div>
<div class="callout-body-container callout-body">
<p>Streng genommen, zeigt sich immer nur die Korrelation zwischen den Variablen. Es ist nicht mÃ¶glich, aus einer Korrelation auf eine KausalitÃ¤t zu schlieÃŸen. Es kÃ¶nnte auch sein, dass ganz andere Effekte die VerkÃ¤ufe beeinflussen, die wir nicht gemessen haben.</p>
</div>
</div>
<p>Wichtig ist auch, dass wir unsere Interpretation der Welt durch unser Modell nicht verabsolutieren. Es ist immer nur eine NÃ¤herung und kann nie die RealitÃ¤t vollstÃ¤ndig abbilden. Wenn wir unser Model wÃ¶rtlich nehmen, kÃ¶nnten wir uns in die Irre fÃ¼hren. Stellen, wir uns vor, die Firma stellt die Werbeausgaben fÃ¼r Zeitungswerbung ein. Dann wÃ¼rde unser Modell den folgenden Absatz vorhersagen:</p>
<p><span class="math display">\[
\text{sales} = - 689.7 \text{units}
\]</span></p>
<p>Ein negativer Absatz ist offensichtlich in der RealitÃ¤t nicht zu erwarten. Entsprechend haben wir den Grenzen unseres Modells erreicht. Die reale Welt lÃ¤sst sich nur in bestimmten Grenzen durch das lineare Modell abbilden.</p>
<div class="callout-quote">
<blockquote class="blockquote">
<p><em>All Models are wrong, some are useful!</em><br>
â€” George E. P. Box,</p>
</blockquote>
</div>
<section id="abbildung-nicht-linearer-zusammenhÃ¤nge-mit-linearen-modellen" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="abbildung-nicht-linearer-zusammenhÃ¤nge-mit-linearen-modellen"><span class="header-section-number">8.1</span> Abbildung nicht-linearer ZusammenhÃ¤nge mit Linearen Modellen</h2>
<p>In der Praxis hÃ¶rt man oft, dass sich lineare Modelle nur fÃ¼r lineare ZusammenhÃ¤nge eignen. Das ist nicht ganz richtig. Lineare Modelle kÃ¶nnen auch nicht-lineare ZusammenhÃ¤nge abbilden. ZunÃ¤chst vergegenwÃ¤rtigen wir uns nochmal was passiert, wenn wir die Vorhersage unseres Modells nur in AbhÃ¤ngigkeit von einer Variablen betrachten. Jeder schwarze Punkt in <span class="citation" data-cites="fig:regression-linear-advanced-linear-regression">(<a href="../references.html#ref-fig:regression-linear-advanced-linear-regression" role="doc-biblioref"><strong>fig:regression-linear-advanced-linear-regression?</strong></a>)</span> zeigt die beobachtete Absatzmenge zu einem Zeitpunkt in AbhÃ¤ngigkeit von den Werbeausgaben fÃ¼r TV-Spots. Der blaue Punkt zeigt die Vorhersage unseres Modells, in das Modell geht natÃ¼rlich auch die Werbeausgaben fÃ¼r Radio- und Zeitungswerbung ein. Deswegen liegen die blauen Punkte nicht auf einer Linie, obwohl wir ein lineares Modell verwenden.</p>
<div id="29eea4f3" class="cell styled-output" data-fig-label="fig:regression-linear-advanced-linear-regression" data-execution_count="5">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Prediction for TV advertising spending</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> X_sample[<span class="dv">0</span>]</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>plt.scatter(X, Y_sample, color<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>Y_pred <span class="op">=</span> model_sm.params[<span class="dv">0</span>] <span class="op">+</span> model_sm.params[<span class="dv">1</span>] <span class="op">*</span> X_1 <span class="op">+</span> model_sm.params[<span class="dv">2</span>] <span class="op">*</span> X_2 <span class="op">+</span> model_sm.params[<span class="dv">3</span>] <span class="op">*</span> X_3</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>plt.scatter(X_1, Y_pred, color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"TV advertising spending (â‚¬)"</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Sales"</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Linear Regression with TV advertising spending (â‚¬)"</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Add legend</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">"Data"</span>, <span class="st">"Prediction"</span>])</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_3603/1829400649.py:6: FutureWarning:

Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
</code></pre>
</div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="advanced_linear_regression_files/figure-html/cell-6-output-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Lineare Regression fÃ¼r die drei unabhÃ¤ngigen Variablen als Plot fÃ¼r eine"><img src="advanced_linear_regression_files/figure-html/cell-6-output-2.png" width="601" height="449" alt="Lineare Regression fÃ¼r die drei unabhÃ¤ngigen Variablen als Plot fÃ¼r eine" class="figure-img"></a></p>
<figcaption>Lineare Regression fÃ¼r die drei unabhÃ¤ngigen Variablen als Plot fÃ¼r eine</figcaption>
</figure>
</div>
</div>
</div>
<p>Manchmal begegnen wir ZusammenhÃ¤ngen, die ganz klar nicht linear sind, beispielsweise der zwischen Verbrauch in Meilen pro Gallone und der Leistung eines Autos. Offensichtlich sinkt der Verbrauch nicht linear mit der Leistung:</p>
<div id="f166bfeb" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="vs">r"../_assets/regression/Auto_Data_Set_963_49.csv"</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># linear model</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> LinearRegression()</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>model.fit(df[[<span class="st">"horsepower"</span>]], df[<span class="st">"mpg"</span>])</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>Y_pred <span class="op">=</span> model.predict(df[[<span class="st">"horsepower"</span>]])</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot between mpg und horsepower</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>plt.scatter(df[<span class="st">"horsepower"</span>], df[<span class="st">"mpg"</span>])</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>plt.plot(df[<span class="st">"horsepower"</span>], Y_pred, color<span class="op">=</span><span class="st">'blue'</span>, linewidth<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Horsepower"</span>)</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Miles per Gallon"</span>)</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Scatter plot between Horsepower and Miles per Gallon"</span>)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Legend with parameters</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="ss">f"Linear Model: $Y = </span><span class="sc">{</span>model<span class="sc">.</span>intercept_<span class="sc">:.1f}</span><span class="ss"> + </span><span class="sc">{</span>model<span class="sc">.</span>coef_[<span class="dv">0</span>]<span class="sc">:.1f}</span><span class="ss">X$"</span>])</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Add RSS</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="advanced_linear_regression_files/figure-html/cell-7-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="advanced_linear_regression_files/figure-html/cell-7-output-1.png" width="585" height="449" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>Eine LÃ¶sung ist die <strong>Transformation</strong> der unabhÃ¤ngigen Variablen. In unserem Beispiel kÃ¶nnten wir die Quadratwurzel der Leistung verwenden. Das Modell wird dann wie folgt aussehen:</p>
<p><span class="math display">\[
\text{mpg} = \beta_0 + \beta_1 \sqrt{\text{horsepower}} + \epsilon
\]</span></p>
<div id="a2ae5aef" class="cell styled-output" data-fig-label="fig:regression-linear-advanced-linear-regression-transformed" data-execution_count="7">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformation of the independent variable</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"sqrt_horsepower"</span>] <span class="op">=</span> np.sqrt(df[<span class="st">"horsepower"</span>])</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># linear model</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> LinearRegression()</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>model.fit(df[[<span class="st">"sqrt_horsepower"</span>]], df[<span class="st">"mpg"</span>])</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort before plotting</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.sort_values(by<span class="op">=</span><span class="st">"horsepower"</span>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>Y_pred <span class="op">=</span> model.predict(df[[<span class="st">"sqrt_horsepower"</span>]])</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot between mpg und horsepower</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>plt.scatter(df[<span class="st">"horsepower"</span>], df[<span class="st">"mpg"</span>])</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>plt.plot(df[<span class="st">"horsepower"</span>], Y_pred, color<span class="op">=</span><span class="st">'blue'</span>, linewidth<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Horsepower"</span>)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Miles per Gallon"</span>)</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Scatter plot between Horsepower and Miles per Gallon"</span>)</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Legend with parameters</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="ss">f"Linear Model: $Y = </span><span class="sc">{</span>model<span class="sc">.</span>intercept_<span class="sc">:.1f}</span><span class="ss"> </span><span class="sc">{</span>model<span class="sc">.</span>coef_[<span class="dv">0</span>]<span class="sc">:.1f}</span><span class="ss">X^</span><span class="ch">{{</span><span class="ss">0.5</span><span class="ch">}}</span><span class="ss">$"</span>])</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="advanced_linear_regression_files/figure-html/cell-8-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Lineare Regression fÃ¼r mit transformierten unabhÃ¤ngigen Variablen"><img src="advanced_linear_regression_files/figure-html/cell-8-output-1.png" width="585" height="449" alt="Lineare Regression fÃ¼r mit transformierten unabhÃ¤ngigen Variablen" class="figure-img"></a></p>
<figcaption>Lineare Regression fÃ¼r mit transformierten unabhÃ¤ngigen Variablen</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Feature Engineering
</div>
</div>
<div class="callout-body-container callout-body">
<p>Die Transformation der unabhÃ¤ngigen Variablen wird auch als <strong>Feature Engineering</strong> bezeichnet. Feature Engineering ist ein wichtiger Schritt in der Modellierung, um die LeistungsfÃ¤higkeit von Modellen zu verbessern.</p>
</div>
</div>
</section>
<section id="umgang-mit-kategorischen-variablen" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="umgang-mit-kategorischen-variablen"><span class="header-section-number">8.2</span> Umgang mit Kategorischen Variablen</h2>
<p>Bisher haben wir nur numerische Variablen betrachtet. In der Praxis haben wir es aber oft mit kategorischen Variablen zu tun. Kategorische Variablen sind Variablen, die eine endliche Anzahl von Kategorien haben. Beispiele sind Geschlecht, Region oder Produkttyp. Beispielsweise wird im Car-Data-Set die Herkunft der Autos erfasst.</p>
<div id="bd7d307f" class="cell styled-output" data-execution_count="8">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"origin"</span>] <span class="op">=</span> df[<span class="st">"origin"</span>].<span class="bu">map</span>({<span class="dv">1</span>: <span class="st">"USA"</span>, <span class="dv">2</span>: <span class="st">"Europe"</span>, <span class="dv">3</span>: <span class="st">"Japan"</span>})</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"origin"</span>].value_counts().plot(kind<span class="op">=</span><span class="st">'bar'</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Origin"</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Count"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>Text(0, 0.5, 'Count')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="advanced_linear_regression_files/figure-html/cell-9-output-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="advanced_linear_regression_files/figure-html/cell-9-output-2.png" width="593" height="463" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>Nun wollen wir untersuchen, ob wir die Herkunft der Autos verwenden kÃ¶nnen, um den Verbrauch vorherzusagemn. Wie immer starten wir mit einer explorativen Analyse.</p>
<div id="3ef5c61f" class="cell styled-output" data-execution_count="9">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">"origin"</span>, y<span class="op">=</span><span class="st">"mpg"</span>, data<span class="op">=</span>df)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Origin"</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Miles per Gallon"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>Text(0, 0.5, 'Miles per Gallon')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="advanced_linear_regression_files/figure-html/cell-10-output-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="advanced_linear_regression_files/figure-html/cell-10-output-2.png" width="585" height="429" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>Offensichtlich gibt es hier einen Zusammenhang. Wir wollen unser Modell von vorhin erweiten, um es weiter zu verbessern. Um kategoriale Variablen in einer Linearen Regression zu BerÃ¼cksichtigen gibt es zwei MÃ¶glichkeiten.</p>
<section id="dummy-variablen" class="level3" data-number="8.2.1">
<h3 data-number="8.2.1" class="anchored" data-anchor-id="dummy-variablen"><span class="header-section-number">8.2.1</span> Dummy-Variablen</h3>
<p>Dummy-Variablen ermÃ¶glichen die Einbindung kategorischer Variablen in lineare Regressionsmodelle, indem sie jede Kategorie (auÃŸer einer Referenzkategorie) durch eine binÃ¤re Variable (0 oder 1) darstellen. FÃ¼r eine Variable mit <span class="math inline">\(k\)</span> Kategorien benÃ¶tigt man <span class="math inline">\(k-1\)</span> Dummy-Variablen, da die Referenzkategorie durch das Fehlen aller Dummy-Variablen kodiert wird. Dies vermeidet MehrkollinearitÃ¤t, da die Kategorien sonst linear abhÃ¤ngig wÃ¤ren.</p>
<p><strong>Beispiel</strong>: Wir verwenden die Spalte â€žoriginâ€œ (USA, Europe, Japan) aus dem Auto-Datensatz und erstellen Dummy-Variablen mit USA als Referenzkategorie.</p>
<div id="a791d144" class="cell styled-output" data-execution_count="10">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Lade den Datensatz</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="vs">r"../_assets/regression/Auto_Data_Set_963_49.csv"</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"origin"</span>] <span class="op">=</span> df[<span class="st">"origin"</span>].<span class="bu">map</span>({<span class="dv">1</span>: <span class="st">"USA"</span>, <span class="dv">2</span>: <span class="st">"Europe"</span>, <span class="dv">3</span>: <span class="st">"Japan"</span>})</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Erstelle Dummy-Variablen</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>dummy_df <span class="op">=</span> pd.get_dummies(df[<span class="st">"origin"</span>], prefix<span class="op">=</span><span class="st">"origin"</span>, drop_first<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co"># FÃ¼ge die Dummy-Variablen zum DataFrame hinzu</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>df_with_dummies <span class="op">=</span> pd.concat([df[[<span class="st">"mpg"</span>, <span class="st">"horsepower"</span>]], dummy_df], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Zeige die ersten Zeilen des DataFrames</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_with_dummies.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    mpg  horsepower  origin_Japan  origin_USA
0  18.0         130         False        True
1  15.0         165         False        True
2  18.0         150         False        True
3  16.0         150         False        True
4  17.0         140         False        True</code></pre>
</div>
</div>
<p><strong>Ergebnis</strong>: Der DataFrame enthÃ¤lt nun zwei neue Spalten: <code>origin_Japan</code> und <code>origin_USA</code>. Wenn <code>origin_Japan = 1</code>, ist das Auto aus Japan; wenn <code>origin_USA = 1</code>, aus den USA; wenn beide 0 sind, aus Europa (Referenzkategorie).</p>
<p><strong>Interpretation</strong>: Diese Dummy-Variablen kÃ¶nnen in eine lineare Regression eingebunden werden, um den Einfluss der Herkunft auf den Verbrauch (<code>mpg</code>) zu modellieren. Der Koeffizient von <code>origin_Japan</code> gibt den Unterschied im durchschnittlichen Verbrauch zwischen europÃ¤ischen und japanischen Autos an, bei konstanten anderen Variablen.</p>
</section>
<section id="one-hot-encoding" class="level3" data-number="8.2.2">
<h3 data-number="8.2.2" class="anchored" data-anchor-id="one-hot-encoding"><span class="header-section-number">8.2.2</span> One-Hot-Encoding</h3>
<p>One-Hot-Encoding kodiert jede Kategorie einer kategorischen Variable durch eine eigene binÃ¤re Spalte, was <span class="math inline">\(k\)</span> Spalten fÃ¼r <span class="math inline">\(k\)</span> Kategorien ergibt. Im Gegensatz zu Dummy-Variablen wird keine Referenzkategorie weggelassen, was in linearen Regressionen zu MehrkollinearitÃ¤t fÃ¼hren kann, wenn der Intercept im Modell enthalten ist. In solchen FÃ¤llen wird oft eine Spalte entfernt oder der Intercept ausgeschlossen.</p>
<p><strong>Beispiel</strong>: Wir erstellen ein One-Hot-Encoding fÃ¼r die Spalte â€žoriginâ€œ (USA, Europe, Japan) im Auto-Datensatz.</p>
<div id="9e0d1a42" class="cell styled-output" data-execution_count="11">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Lade den Datensatz</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="vs">r"../_assets/regression/Auto_Data_Set_963_49.csv"</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"origin"</span>] <span class="op">=</span> df[<span class="st">"origin"</span>].<span class="bu">map</span>({<span class="dv">1</span>: <span class="st">"USA"</span>, <span class="dv">2</span>: <span class="st">"Europe"</span>, <span class="dv">3</span>: <span class="st">"Japan"</span>})</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Erstelle One-Hot-Encoding</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>one_hot_df  <span class="op">=</span>  pd.get_dummies(df[<span class="st">"origin"</span>], prefix<span class="op">=</span><span class="st">"origin"</span>, drop_first<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co"># FÃ¼ge die One-Hot-Encoding-Spalten zum DataFrame hinzu</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>df_with_one_hot <span class="op">=</span> pd.concat([df[[<span class="st">"mpg"</span>, <span class="st">"horsepower"</span>]], one_hot_df], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Zeige die ersten Zeilen des DataFrames</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_with_one_hot.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    mpg  horsepower  origin_Europe  origin_Japan  origin_USA
0  18.0         130          False         False        True
1  15.0         165          False         False        True
2  18.0         150          False         False        True
3  16.0         150          False         False        True
4  17.0         140          False         False        True</code></pre>
</div>
</div>
<p><strong>Ergebnis</strong>: Der DataFrame enthÃ¤lt drei neue Spalten: <code>origin_USA</code>, <code>origin_Europe</code> und <code>origin_Japan</code>. Jede Spalte zeigt an, ob ein Auto der jeweiligen Kategorie angehÃ¶rt (1) oder nicht (0).</p>
<p><strong>Interpretation</strong>: In einer linearen Regression mit diesen One-Hot-kodierten Variablen und einem Intercept wÃ¼rde eine der Spalten (z. B. <code>origin_USA</code>) entfernt werden mÃ¼ssen, um MehrkollinearitÃ¤t zu vermeiden. Alternativ kann das Modell ohne Intercept geschÃ¤tzt werden, wobei jede Spalte den durchschnittlichen Verbrauch der jeweiligen Kategorie reprÃ¤sentiert.</p>
</section>
<section id="modell-nur-mit-kategorischen-variablen" class="level3" data-number="8.2.3">
<h3 data-number="8.2.3" class="anchored" data-anchor-id="modell-nur-mit-kategorischen-variablen"><span class="header-section-number">8.2.3</span> Modell nur mit Kategorischen Variablen</h3>
<p>Ein Regressionsmodell, das ausschlieÃŸlich kategorische Variablen verwendet, schÃ¤tzt die Mittelwerte der abhÃ¤ngigen Variable fÃ¼r jede Kategorie. FÃ¼r die Herkunft (USA, Europe, Japan) modelliert das Modell den durchschnittlichen Kraftstoffverbrauch (<code>mpg</code>) pro Land. Der Intercept entspricht dem durchschnittlichen Verbrauch der Referenzkategorie, wÃ¤hrend die Koeffizienten der Dummy-Variablen die Differenz im Verbrauch der anderen Kategorien im Vergleich zur Referenzkategorie angeben.</p>
<p><strong>Beispiel</strong>: Wir erstellen ein Modell, das den Verbrauch (<code>mpg</code>) basierend auf der Herkunft vorhersagt, mit USA als Referenzkategorie.</p>
<div id="0ebfbf09" class="cell styled-output" data-execution_count="12">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Lade den Datensatz</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="vs">r"../_assets/regression/Auto_Data_Set_963_49.csv"</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"origin"</span>] <span class="op">=</span> df[<span class="st">"origin"</span>].<span class="bu">map</span>({<span class="dv">1</span>: <span class="st">"USA"</span>, <span class="dv">2</span>: <span class="st">"Europe"</span>, <span class="dv">3</span>: <span class="st">"Japan"</span>})</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Erstelle Dummy-Variablen (USA als Referenzkategorie)</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> pd.get_dummies(df[<span class="st">"origin"</span>], prefix<span class="op">=</span><span class="st">"origin"</span>, drop_first<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> sm.add_constant(X)  <span class="co"># FÃ¼ge Intercept hinzu</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Wandle Booleans in numerische Werte um</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> X.astype(<span class="bu">int</span>)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X.head())</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitte das Modell</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> sm.OLS(df[<span class="st">"mpg"</span>], X).fit()</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Zeige die Zusammenfassung</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   const  origin_Japan  origin_USA
0      1             0           1
1      1             0           1
2      1             0           1
3      1             0           1
4      1             0           1
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                    mpg   R-squared:                       0.332
Model:                            OLS   Adj. R-squared:                  0.328
Method:                 Least Squares   F-statistic:                     96.60
Date:                Tue, 03 Jun 2025   Prob (F-statistic):           8.67e-35
Time:                        09:47:28   Log-Likelihood:                -1282.2
No. Observations:                 392   AIC:                             2570.
Df Residuals:                     389   BIC:                             2582.
Df Model:                           2                                         
Covariance Type:            nonrobust                                         
================================================================================
                   coef    std err          t      P&gt;|t|      [0.025      0.975]
--------------------------------------------------------------------------------
const           27.6029      0.776     35.587      0.000      26.078      29.128
origin_Japan     2.8477      1.058      2.691      0.007       0.767       4.928
origin_USA      -7.5695      0.877     -8.634      0.000      -9.293      -5.846
==============================================================================
Omnibus:                       26.330   Durbin-Watson:                   0.763
Prob(Omnibus):                  0.000   Jarque-Bera (JB):               30.217
Skew:                           0.679   Prob(JB):                     2.74e-07
Kurtosis:                       3.066   Cond. No.                         5.42
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</code></pre>
</div>
</div>
<p><strong>Ergebnis und Interpretation</strong>:</p>
<ul>
<li><strong>Intercept</strong>: Der Intercept reprÃ¤sentiert den durchschnittlichen Verbrauch (<code>mpg</code>) von Autos aus den USA (Referenzkategorie). Zum Beispiel, wenn der Intercept 27.6 ist, bedeutet dies, dass europÃ¤ische Autos im Durchschnitt 27.6 Meilen pro Gallone erreichen.</li>
<li><strong>Koeffizienten</strong>:
<ul>
<li>Der Koeffizient fÃ¼r <code>origin_Japan</code> gibt die Differenz im durchschnittlichen Verbrauch zwischen europÃ¤ischen und japanischen Autos an. Ein positiver Koeffizient (z. B. 2.8) bedeutet, dass japanische Autos im Durchschnitt 2.8 Meilen pro Gallone sparsamer sind als europÃ¤ische Autos.</li>
<li>Der Koeffizient fÃ¼r <code>origin_USA</code> interpretiert sich analog.</li>
</ul></li>
<li><strong>ModellqualitÃ¤t</strong>: Der <span class="math inline">\(R^2\)</span>-Wert gibt an, wie viel der Varianz im Verbrauch durch die Herkunft erklÃ¤rt wird. Ein niedriger <span class="math inline">\(R^2\)</span> deutet darauf hin, dass andere Faktoren (z. B. Leistung) ebenfalls wichtig sind.</li>
</ul>
<p>Dieses Modell ist einfach zu interpretieren, da es nur die Mittelwerte pro Kategorie vergleicht, Ã¤hnlich einer ANOVA oder einem T-Test.</p>
</section>
<section id="modell-mit-allen-variablen" class="level3" data-number="8.2.4">
<h3 data-number="8.2.4" class="anchored" data-anchor-id="modell-mit-allen-variablen"><span class="header-section-number">8.2.4</span> Modell mit allen Variablen</h3>
<p>Ein Modell, das numerische und kategorische Variablen kombiniert, nutzt alle verfÃ¼gbaren PrÃ¤diktoren, um die abhÃ¤ngige Variable zu modellieren. Dies fÃ¼hrt oft zu einer hÃ¶heren ErklÃ¤rungskraft (z. B. hÃ¶herem <span class="math inline">\(R^2\)</span>), da mehr Informationen berÃ¼cksichtigt werden. Die Interpretation wird jedoch komplexer, da die Koeffizienten unter der Annahme interpretiert werden, dass alle anderen Variablen konstant sind.</p>
<p><strong>Beispiel</strong>: Wir modellieren den Verbrauch (<code>mpg</code>) basierend auf der Leistung (<code>horsepower</code>), deren Quadratwurzel (fÃ¼r nicht-lineare Effekte) und der Herkunft (als Dummy-Variablen, USA als Referenzkategorie).</p>
<div id="4a70d77b" class="cell styled-output" data-execution_count="13">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Lade den Datensatz</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="vs">r"../_assets/regression/Auto_Data_Set_963_49.csv"</span>)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"origin"</span>] <span class="op">=</span> df[<span class="st">"origin"</span>].<span class="bu">map</span>({<span class="dv">1</span>: <span class="st">"USA"</span>, <span class="dv">2</span>: <span class="st">"Europe"</span>, <span class="dv">3</span>: <span class="st">"Japan"</span>})</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Erstelle transformierte Variable</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"sqrt_horsepower"</span>] <span class="op">=</span> np.sqrt(df[<span class="st">"horsepower"</span>])</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Erstelle Dummy-Variablen</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> pd.get_dummies(df[<span class="st">"origin"</span>], prefix<span class="op">=</span><span class="st">"origin"</span>, drop_first<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="co"># FÃ¼ge numerische Variablen hinzu</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>X[<span class="st">"horsepower"</span>] <span class="op">=</span> df[<span class="st">"horsepower"</span>]</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>X[<span class="st">"sqrt_horsepower"</span>] <span class="op">=</span> df[<span class="st">"sqrt_horsepower"</span>]</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="co"># FÃ¼ge Intercept hinzu</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> sm.add_constant(X)</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Wandle Booleans in numerische Werte um</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> X.astype(<span class="bu">float</span>)</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitte das Modell</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> sm.OLS(df[<span class="st">"mpg"</span>], X).fit()</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Zeige die Zusammenfassung</span></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                    mpg   R-squared:                       0.719
Model:                            OLS   Adj. R-squared:                  0.716
Method:                 Least Squares   F-statistic:                     247.8
Date:                Tue, 03 Jun 2025   Prob (F-statistic):          2.51e-105
Time:                        09:47:28   Log-Likelihood:                -1112.2
No. Observations:                 392   AIC:                             2234.
Df Residuals:                     387   BIC:                             2254.
Df Model:                           4                                         
Covariance Type:            nonrobust                                         
===================================================================================
                      coef    std err          t      P&gt;|t|      [0.025      0.975]
-----------------------------------------------------------------------------------
const              95.6047      6.489     14.734      0.000      82.847     108.362
origin_Japan        2.8432      0.688      4.134      0.000       1.491       4.195
origin_USA         -1.2807      0.632     -2.026      0.043      -2.523      -0.038
horsepower          0.3650      0.057      6.456      0.000       0.254       0.476
sqrt_horsepower   -10.9359      1.232     -8.875      0.000     -13.359      -8.513
==============================================================================
Omnibus:                       17.102   Durbin-Watson:                   1.198
Prob(Omnibus):                  0.000   Jarque-Bera (JB):               26.045
Skew:                           0.324   Prob(JB):                     2.21e-06
Kurtosis:                       4.084   Cond. No.                     3.52e+03
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 3.52e+03. This might indicate that there are
strong multicollinearity or other numerical problems.</code></pre>
</div>
</div>
<p><strong>Ergebnis und Interpretation</strong>:</p>
<ul>
<li><strong>ModellgÃ¼te</strong>: Der <span class="math inline">\(R^2\)</span>-Wert ist hÃ¶her als in Modellen mit nur numerischen oder nur kategorischen Variablen, da das Modell mehr Informationen nutzt. Zum Beispiel kÃ¶nnte <span class="math inline">\(R^2 = 0.75\)</span> bedeuten, dass 75 % der Varianz im Verbrauch erklÃ¤rt werden.</li>
<li><strong>Koeffizienten</strong>:
<ul>
<li>Der Koeffizient fÃ¼r <code>horsepower</code> und <code>sqrt_horsepower</code> gibt den Einfluss der Leistung auf den Verbrauch an, unter BerÃ¼cksichtigung der nicht-linearen Beziehung.</li>
</ul></li>
<li><strong>Interpretationsschwierigkeit</strong>: Die Koeffizienten sind schwerer zu interpretieren, da sie unter der Annahme konstanter anderer Variablen gelten. Zum Beispiel kÃ¶nnte der Einfluss von <code>horsepower</code> durch die Quadratwurzel-Transformation komplexer sein.</li>
<li><strong>Vorsicht</strong>: Ein komplexeres Modell kann zu Ãœberanpassung fÃ¼hren, insbesondere bei kleinen DatensÃ¤tzen, und die Interpretation kann fÃ¼r praktische Entscheidungen unpraktisch werden.</li>
</ul>
<p>Dieses Modell ist leistungsfÃ¤higer, aber die Interpretation erfordert ein tieferes VerstÃ¤ndnis der ZusammenhÃ¤nge und der Modellannahmen.</p>
</section>
</section>
<section id="matrixschreibweise-der-linearen-regression" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="matrixschreibweise-der-linearen-regression"><span class="header-section-number">8.3</span> Matrixschreibweise der linearen Regression</h2>
<p>Die lineare Regression schÃ¤tzt die abhÃ¤ngige Variable <span class="math inline">\(y\)</span> als lineare Kombination der PrÃ¤diktoren <span class="math inline">\(x_1, x_2, \dots, x_p\)</span> plus eines Intercepts. Mathematisch wird dies als Matrixmultiplikation dargestellt, was die Berechnung effizient macht, insbesondere bei vielen Beobachtungen und PrÃ¤diktoren. Formel Die lineare Regression fÃ¼r <span class="math inline">\(n\)</span> Beobachtungen und <span class="math inline">\(p\)</span> PrÃ¤diktoren (inkl. Intercept) lautet: <span class="math display">\[\mathbf{y} = \mathbf{X} \boldsymbol{\beta} + \boldsymbol{\epsilon}\]</span></p>
<ul>
<li><span class="math inline">\(\mathbf{y}\)</span>: Vektor der abhÃ¤ngigen Variable (<span class="math inline">\(n \times 1\)</span>).</li>
<li><span class="math inline">\(\mathbf{X}\)</span>: Designmatrix (<span class="math inline">\(n \times (p+1)\)</span>), enthÃ¤lt eine Spalte fÃ¼r den Intercept (konstante 1) und die PrÃ¤diktoren.</li>
<li><span class="math inline">\(\boldsymbol{\beta}\)</span>: Koeffizientenvektor (<span class="math inline">\(((p+1) \times 1)\)</span>), enthÃ¤lt Intercept und Koeffizienten der PrÃ¤diktoren.</li>
<li><span class="math inline">\(\boldsymbol{\epsilon}\)</span>: Fehlervektor (<span class="math inline">\(n \times 1\)</span>).</li>
</ul>
<p>Die vorhergesagten Werte sind: <span class="math display">\[\hat{\mathbf{y}} = \mathbf{X} \boldsymbol{\beta}\]</span> Matrixdarstellung mit Variablen FÃ¼r die OLS-Regression mit mpg als abhÃ¤ngige Variable und PrÃ¤diktoren origin_Japan, origin_USA, horsepower, sqrt_horsepower lautet die Matrixform:</p>
<p><span class="math display">\[
\begin{bmatrix}
\hat{y}_1 \\
\hat{y}_2 \\
\vdots \\
\hat{y}_n
\end{bmatrix}
=
\begin{bmatrix}
1 &amp; x_{1,\text{Japan}} &amp; x_{1,\text{USA}} &amp; x_{1,\text{hp}} &amp; x_{1,\text{sqrt\_hp}} \\
1 &amp; x_{2,\text{Japan}} &amp; x_{2,\text{USA}} &amp; x_{2,\text{hp}} &amp; x_{2,\text{sqrt\_hp}} \\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
1 &amp; x_{n,\text{Japan}} &amp; x_{n,\text{USA}} &amp; x_{n,\text{hp}} &amp; x_{n,\text{sqrt\_hp}}
\end{bmatrix}
\begin{bmatrix}
\beta_0 \\
\beta_1 \\
\beta_2 \\
\beta_3 \\
\beta_4
\end{bmatrix}
\]</span></p>
<ul>
<li><span class="math inline">\(\beta_0\)</span>: Intercept (const).</li>
<li><span class="math inline">\(\beta_1, \beta_2\)</span>: Koeffizienten fÃ¼r origin_Japan, origin_USA.</li>
<li><span class="math inline">\(\beta_3, \beta_4\)</span>: Koeffizienten fÃ¼r horsepower, sqrt_horsepower.</li>
<li><span class="math inline">\(x_{i,\text{Japan}}, x_{i,\text{USA}}\)</span>: Dummy-Variablen (0 oder 1).</li>
<li><span class="math inline">\(x_{i,\text{hp}}, x_{i,\text{sqrt\_hp}}\)</span>: Werte fÃ¼r horsepower und dessen Quadratwurzel.</li>
</ul>
<section id="konkretes-beispiel" class="level3" data-number="8.3.1">
<h3 data-number="8.3.1" class="anchored" data-anchor-id="konkretes-beispiel"><span class="header-section-number">8.3.1</span> Konkretes Beispiel</h3>
<p>Nehmen wir die Koeffizienten aus der OLS-Ausgabe:</p>
<ul>
<li><span class="math inline">\(\beta_0 = 95.6047\)</span> (const)</li>
<li><span class="math inline">\(\beta_1 = 2.8432\)</span> (origin_Japan)</li>
<li><span class="math inline">\(\beta_2 = -1.2807\)</span> (origin_USA)</li>
<li><span class="math inline">\(\beta_3 = 0.3650\)</span> (horsepower)</li>
<li><span class="math inline">\(\beta_4 = -10.9359\)</span> (sqrt_horsepower)</li>
</ul>
<p>FÃ¼r drei Beobachtungen aus dem Datensatz (angenommen):</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Beobachtung</th>
<th>origin</th>
<th>horsepower</th>
<th>sqrt_horsepower</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>USA</td>
<td>130</td>
<td><span class="math inline">\(\sqrt{130} \approx 11.40\)</span></td>
</tr>
<tr class="even">
<td>2</td>
<td>Japan</td>
<td>88</td>
<td><span class="math inline">\(\sqrt{88} \approx 9.38\)</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td>Europe</td>
<td>100</td>
<td><span class="math inline">\(\sqrt{100} = 10.00\)</span></td>
</tr>
</tbody>
</table>
<p>Die Designmatrix <span class="math inline">\(\mathbf{X}\)</span> fÃ¼r diese Beobachtungen ist:</p>
<p><span class="math display">\[
\mathbf{X} =
\begin{bmatrix}
1 &amp; 0 &amp; 1 &amp; 130 &amp; 11.40 \\
1 &amp; 1 &amp; 0 &amp; 88 &amp; 9.38 \\
1 &amp; 0 &amp; 0 &amp; 100 &amp; 10.00 \\
\end{bmatrix}
\]</span></p>
<p>Der Koeffizientenvektor ist:</p>
<p><span class="math display">\[
\boldsymbol{\beta} =
\begin{bmatrix}
95.6047 \\
2.8432 \\
-1.2807 \\
0.3650 \\
-10.9359 \\
\end{bmatrix}
\]</span></p>
<p>Die vorhergesagten Werte <span class="math inline">\(\hat{\mathbf{y}}\)</span> berechnen sich durch <span class="math inline">\(\hat{\mathbf{y}} = \mathbf{X} \boldsymbol{\beta}\)</span>. FÃ¼r Beobachtung 1 (USA):</p>
<p><span class="math display">\[
\begin{align*}
\hat{y}_1 &amp;= 95.6047 + 0 \cdot 2.8432 + 1 \cdot (-1.2807) + 130 \cdot 0.3650 + 11.40 \cdot (-10.9359) \\
          &amp;= 95.6047 - 1.2807 + 47.45 - 124.66 \\
          &amp;= 17.11
\end{align*}
\]</span></p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/jhumci\.github\.io\/MECH-B-4-MLDS-MLDS1");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../regression/basic_linear_regression.html" class="pagination-link" aria-label="Lineare Regression">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Lineare Regression</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../regression/predictions_linear_regression.html" class="pagination-link" aria-label="Vorhersagen mittels Linearen Regression">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Vorhersagen mittels Linearen Regression</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Machine Learning and Data Science 1 SoSe 2025 (MECH-B-4-MLDS-MLDS1)</p>
</div>   
    <div class="nav-footer-center">
<p><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> Julian Huber</p>
<div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jhumci/MECH-B-4-MLDS-MLDS1/edit/main/regression/advanced_linear_regression.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/jhumci/MECH-B-4-MLDS-MLDS1/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>